<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><title>Turn-Based Game With Go【译】</title>
<meta charset=utf-8><meta name=description content="Ladder@
Today we will talk about how to write a simple turn-based game engine with Go. While writing our character’s abilities and fights with each other, we will use Interfaces,channels, and concurrency with Golang

今天我们将讨论下如何使用Golang编写一个简单的基于回合制的游戏引擎.在实现角色的能力和与其他角色战斗的功能时，我们会使用到Golang的Interface,channels,concurrency等特性。"><meta name=author content="map[email:axlrose.huang@gmail.com name:Axlrose]"><link rel=canonical href=https://echotrue.github.io/blog/game/turn-based-game-with-go/><link rel=alternate type=application/rss+xml href=https://echotrue.github.io//index.xml title=AXLROSE><meta property="og:url" content="https://echotrue.github.io/blog/game/turn-based-game-with-go/"><meta property="og:site_name" content="AXLROSE"><meta property="og:title" content="Turn-Based Game With Go【译】"><meta property="og:description" content="Today we will talk about how to write a simple turn-based game engine with Go. While writing our character’s abilities and fights with each other, we will use Interfaces,channels, and concurrency with Golang
今天我们将讨论下如何使用Golang编写一个简单的基于回合制的游戏引擎.在实现角色的能力和与其他角色战斗的功能时，我们会使用到Golang的Interface,channels,concurrency等特性。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-09-06T16:32:53+08:00"><meta property="article:modified_time" content="2021-09-06T16:32:53+08:00"><meta property="article:tag" content="Game"><meta property="article:tag" content="Combat"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://echotrue.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Turn-Based Game With Go【译】","item":"https://echotrue.github.io/blog/game/turn-based-game-with-go/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Turn-Based Game With Go【译】","name":"Turn-Based Game With Go【译】","description":" Today we will talk about how to write a simple turn-based game engine with Go. While writing our character’s abilities and fights with each other, we will use Interfaces,channels, and concurrency with Golang\n今天我们将讨论下如何使用Golang编写一个简单的基于回合制的游戏引擎.在实现角色的能力和与其他角色战斗的功能时，我们会使用到Golang的Interface,channels,concurrency等特性。\n","keywords":["game","combat"],"articleBody":" Today we will talk about how to write a simple turn-based game engine with Go. While writing our character’s abilities and fights with each other, we will use Interfaces,channels, and concurrency with Golang\n今天我们将讨论下如何使用Golang编写一个简单的基于回合制的游戏引擎.在实现角色的能力和与其他角色战斗的功能时，我们会使用到Golang的Interface,channels,concurrency等特性。\nIf you don’t have any idea about the turn-based game, it is about the different types of characters with different strengths, and different abilities fight and kill each other one by one. The winner is the survived last person.\n如果你对回合制游戏一无所知，这里可以简单概括下。回合制游戏就是拥有不同力量，不同能力的各类角色之间互相战斗并逐个杀死对方. 获胜者是最后的幸存者。\nTurn Game Rules Fights mean every Warrier hit only the one Warrier in Turn. Every attacker loses stamina or mana after hit to an opponent. 战斗意味着每个战士每个回合只能攻击一个战士。每一个攻击者在击中对手后会失去体力值或者魔法值.\nEvery Hit damage is changed by Warrier’s Level and his Weapon, Magic, or Animal kind. 每一次命中的伤害会因战士的等级，武器，法力，或者宠物类型而不同\nWhen a warrior is damaged by someone else, his or her blood will decreases. If the blood value is zero or less, he will die. 当一个战士被其他人伤害时，他的血量会减少，如果血量值降到0或者更少，他将会死亡.\nIf a warrior’s stamina or mana less than zero, he can’t hit or make magic until the next Turn. Next Turn, his mana or stamina will be full. 如果一个战士的体力或者魔法值少于0，在下一回合之前他将不能施放技能。下一回合他的体力或者魔法值将会充满。\nFirstly let’s create base traits struct of these types of characters.\n首先,创建不同角色的基础属性结构体\nheroCharacter/heroCharacter.go: All the characters have Name, Level (experience),Attacks(Damage List) and Blood(Energy)\n所有的角色都有角色名称，等级（经验），攻击力（伤害列表）和血量（能量）\npackage heroCharacter type Hero struct { Name string Level int Attacks map[string]int Blood int } Let’s Create all Characters Interface. We will list all character’s common Actions in this interface.\n创建角色interface,在这个接口中我们将定义所有角色通用的操作行为的方法。\nfightHero/fightHero.go: Every hero Hits the other characters, takes Damage after attacked by someone else. We can get info about him or her healthy, stamina or mana.And finally, we can check he or she died or not. These are the common functions of all Characters.\n每个英雄角色击中其他角色，或者收到其他人的攻击。我们会获取他的健康，魔法或者体力信息.然后,检查他是否死亡.这是所有角色的通用方法。\npackage fightHero type FightHero interface { Hit() int TakeDamage(damage int) GetInfo() (string, int) IsDeath() bool } Wizard Let’s create first character Wizard.\n创建第一个角色男巫\nwizard/wizard.go:\nproperties of Wizard type( Wizard struct{ hero.Hero Manas map[string]int Mana int Magic string } ) Hero: Common character’s properties.\nHero:角色通用属性\nManas: This is a collection of “string” magic names with their “int” mana costs.Example: “Manas: map[string]int{“FireBall”: 5, “Thunder”: 10, “Ghost Attack”:30}}”\nManas：魔法值消耗列表.魔法技能名称作为key,魔法技能消耗的魔法值作为value.示例中火球技能消耗5点魔法值,闪电技能消耗10点,幽灵攻击消耗30点\nMana: This is integer Wizard’s mana value. Wizard needs mana, for making Magic.Without mana Wizard is nothing :)\nMana:魔法值,男巫的魔法值,男巫需要魔法值来施放魔法技能.没有魔法值,男巫啥也不是.\nMagic: This is Wizard’s weapon. He or she can hit an enemy with the Magic. Example: “map[string]int{“FireBall”: 25, “Thunder”: 18, “Ghost Attack”: 30}”\nMagic: 这是男巫的武器,他可以使用魔法技能攻击敌人.\nAction of Wizard FightHero interface Methods: Hit()计算魔法技能伤害值,只有法力值足够的前提下才能施放魔法技能,魔法技能的伤害值和等级有关系.\nfunc (w Wizard) Hit() int { if w.Mana \u003e= w.Manas[w.Magic] { levelEffect := int(math.Ceil(float64(w.Level) * 0.1)) return w.Attacks[w.Magic] + levelEffect } return 0 } TakeDamage 如果被其他角色攻击,血量将会减少,当血量为0时,男巫就会死亡.此处使用了指针类型*Wizard,因为当男巫受到伤害时必须及时减少男巫的血量\nfunc (w *Wizard) TakeDamage(damage int) { w.Blood = w.Blood - damage } GetInfo() 获取男巫的名称和血量\nIsDeath(): 检测男巫是否死亡\nWizard Own Methods: GetMana(): 获取男巫当前的法力值\nSpendMana() 消耗男巫的法力值\nCreateWizard() 创建男巫对象\nFighter (参考男巫) Druid (参考男巫) Hero (战斗) 我们已经定义了所有的英雄角色,现在开始让他们之间互相战斗,他们中只有一个能获胜幸存下来. 定义全局变量和随机函数:\nvar fighterList map[string]IHero.FightHero var fighterNumberList map[int]IHero.FightHero func GetRandomID(limit int) int { rand.Seed(time.Now().UnixNano()) rndVictim := rand.Intn(limit) + 1 return rndVictim } func GetRandomBetweenID(minLimit int, maxlimit int) int { rand.Seed(time.Now().UnixNano()) rndVictim := rand.Intn(maxlimit-minLimit) + minLimit + 1 return rndVictim } var isFighterDead bool = false var isWizardDead bool = false var isDruidDead bool = false var TotalLive int = 3 func MapRandomKeyGet(mapI interface{}) interface{} { keys := reflect.ValueOf(mapI).MapKeys() return keys[rand.Intn(len(keys))].Interface() } fighterList以英雄的名称保存英雄信息 fighterNumberList根据英雄ID存储英雄名称 GetRandomID 获取随机数 GetRandomBetweenID 给定范围内获取随机数 isFighterDead, isWizardDead, isDruidDead 每个英雄的生死状态 TotalLive 几条生命 MapRandomKeyGet 用来随机获取Wizzard的魔法技能,Fighter的武器,Druid的宠物 hero/main() 首先我们创建默认的wizard,fighter和druid人物角色。由于每个英雄出手攻击都要等待确保其他英雄的攻击动作已经完成。所以我们使用channels来达到顺序战斗的效果。攻击动作完成之后才会继续接下来的战斗。\nmerlin := wizard.CreateWizard(GetRandomBetweenID(50, 100), GetRandomBetweenID(50, 100)) 如果你注意上面的代码会发现，每个英雄的血量、法力和耐力值都是设置为50到100之间的随机数\nfighterList = map[string]IHero.FightHero{\"fighter\": barbar, \"wizard\": merlin, \"druid\": forest} fighterNumberList = map[int]IHero.FightHero{1: barbar, 2: merlin, 3: forest} 我们会将所有英雄名字和英雄对象以键值对的形式保存在fightList Map中 我们会像枚举一样使用fighterNumberList,随机的从这个map中取英雄 接下来，我们会让角色在一个循环中战斗知道最后只有一个人存活\n","wordCount":"1996","inLanguage":"en","datePublished":"2021-09-06T16:32:53+08:00","dateModified":"2021-09-06T16:32:53+08:00","author":{"@type":"Person","name":{"email":"axlrose.huang@gmail.com","name":"Axlrose"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://echotrue.github.io/blog/game/turn-based-game-with-go/"},"publisher":{"@type":"Organization","name":"AXLROSE","logo":{"@type":"ImageObject","url":"https://echotrue.github.io/favicon.ico"}}}</script><link rel=icon href=/images/avatar.png sizes=16x16><link rel=apple-touch-icon href=/images/avatar.png><link rel=manifest href=/images/avatar.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css><link rel=stylesheet href=/css/main.min.b18e8501c4f9c51c7bc74c831f88a4705978246e383d68ba514a05459901ef6f.css integrity="sha256-sY6FAcT5xRx7x0yDH4ikcFl4JG44PWi6UUoFRZkB728=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/prism.min.ab059a12f053f9764c2b65f5e83ea3a2e77c9957e453e01e0478a8ab6b11109f.css><script src=/js/prism.min.4efeed559740892c1071317ffd1e799722e52463c486cfb182fdef01622950fc.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>HOME
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/blog>Blog</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/series>Series</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/tags>Tags</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archives>Archive</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/book>Book</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>Turn-Based Game With Go【译】</h1></header><p><small>September 6, 2021&nbsp;· 1996 words&nbsp;· 4 min</small>
<small>·
<a href=https://echotrue.github.io/tags/game/>Game</a>
<a href=https://echotrue.github.io/tags/combat/>Combat</a></small><p><div class=blog-toc><nav id=TableOfContents><ul><li><ul><li><a href=#turn-game-rules>Turn Game Rules</a></li><li><a href=#wizard>Wizard</a></li><li><a href=#fighter-参考男巫>Fighter (参考男巫)</a></li><li><a href=#druid-参考男巫>Druid (参考男巫)</a></li><li><a href=#hero-战斗>Hero (战斗)</a></li><li><a href=#heromain>hero/main()</a></li></ul></li></ul></nav></div><section class=blog-content><blockquote><p>Today we will talk about how to write a simple turn-based game engine with Go. While writing our character’s abilities and fights with each other, we will use Interfaces,channels, and concurrency with Golang</p></blockquote><p>今天我们将讨论下如何使用Golang编写一个简单的基于回合制的游戏引擎.在实现角色的能力和与其他角色战斗的功能时，我们会使用到Golang的<code>Interface</code>,<code>channels</code>,<code>concurrency</code>等特性。</p><blockquote><p>If you don’t have any idea about the turn-based game, it is about the different types of characters with different strengths, and different abilities fight and kill each other one by one. The winner is the survived last person.</p></blockquote><p>如果你对回合制游戏一无所知，这里可以简单概括下。回合制游戏就是拥有不同力量，不同能力的各类角色之间互相战斗并逐个杀死对方. 获胜者是最后的幸存者。</p><h3 id=turn-game-rules>Turn Game Rules</h3><blockquote><ol><li>Fights mean every Warrier hit only the one Warrier in Turn. Every attacker loses stamina or mana after hit to an opponent.</li></ol></blockquote><p>战斗意味着每个战士每个回合只能攻击一个战士。每一个攻击者在击中对手后会失去体力值或者魔法值.</p><blockquote><ol start=2><li>Every Hit damage is changed by Warrier’s Level and his Weapon, Magic, or Animal kind.</li></ol></blockquote><p>每一次命中的伤害会因战士的等级，武器，法力，或者宠物类型而不同</p><blockquote><ol start=3><li>When a warrior is damaged by someone else, his or her blood will decreases. If the blood value is zero or less, he will die.</li></ol></blockquote><p>当一个战士被其他人伤害时，他的血量会减少，如果血量值降到0或者更少，他将会死亡.</p><blockquote><ol start=4><li>If a warrior’s stamina or mana less than zero, he can’t hit or make magic until the next Turn. Next Turn, his mana or stamina will be full.</li></ol></blockquote><p>如果一个战士的体力或者魔法值少于0，在下一回合之前他将不能施放技能。下一回合他的体力或者魔法值将会充满。</p><blockquote><p>Firstly let’s create base traits struct of these types of characters.</p></blockquote><p>首先,创建不同角色的基础属性结构体</p><blockquote><p>heroCharacter/heroCharacter.go: All the characters have Name, Level (experience),Attacks(Damage List) and Blood(Energy)</p></blockquote><p>所有的角色都有角色名称，等级（经验），攻击力（伤害列表）和血量（能量）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>heroCharacter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Hero</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Name</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Level</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Attacks</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Blood</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>Let’s Create all Characters Interface. We will list all character’s common Actions in this interface.</p></blockquote><p>创建角色<code>interface</code>,在这个接口中我们将定义所有角色通用的操作行为的方法。</p><blockquote><p>fightHero/fightHero.go: Every hero Hits the other characters, takes Damage after attacked by someone else. We can get info about him or her healthy, stamina or mana.And finally, we can check he or she died or not. These are the common functions of all Characters.</p></blockquote><p>每个英雄角色击中其他角色，或者收到其他人的攻击。我们会获取他的健康，魔法或者体力信息.然后,检查他是否死亡.这是所有角色的通用方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>fightHero</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>FightHero</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Hit</span>() <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>TakeDamage</span>(<span style=color:#a6e22e>damage</span> <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>GetInfo</span>() (<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>IsDeath</span>() <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=wizard>Wizard</h3><blockquote><p>Let’s create first character Wizard.</p></blockquote><p>创建第一个角色男巫</p><p>wizard/wizard.go:</p><h4 id=properties-of-wizard>properties of Wizard</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#66d9ef>type</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Wizard</span> <span style=color:#66d9ef>struct</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>hero</span>.<span style=color:#a6e22e>Hero</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Manas</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Mana</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Magic</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><blockquote><p>Hero: Common character’s properties.</p></blockquote><p>Hero:角色通用属性</p><blockquote><p>Manas: This is a collection of “string” magic names with their “int” mana costs.Example: “Manas: map[string]int{“FireBall”: 5, “Thunder”: 10, “Ghost Attack”:30}}”</p></blockquote><p>Manas：魔法值消耗列表.魔法技能名称作为key,魔法技能消耗的魔法值作为value.示例中火球技能消耗5点魔法值,闪电技能消耗10点,幽灵攻击消耗30点</p><blockquote><p>Mana: This is integer Wizard’s mana value. Wizard needs mana, for making Magic.Without mana Wizard is nothing :)</p></blockquote><p>Mana:魔法值,男巫的魔法值,男巫需要魔法值来施放魔法技能.没有魔法值,男巫啥也不是.</p><blockquote><p>Magic: This is Wizard’s weapon. He or she can hit an enemy with the Magic.
Example: “map[string]int{“FireBall”: 25, “Thunder”: 18, “Ghost Attack”: 30}”</p></blockquote><p>Magic: 这是男巫的武器,他可以使用魔法技能攻击敌人.</p><h4 id=action-of-wizard>Action of Wizard</h4><h5 id=fighthero-interface-methods>FightHero interface Methods:</h5><p><code>Hit()</code>计算魔法技能伤害值,只有法力值足够的前提下才能施放魔法技能,魔法技能的伤害值和等级有关系.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>Wizard</span>) <span style=color:#a6e22e>Hit</span>() <span style=color:#66d9ef>int</span> {  
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Mana</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Manas</span>[<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Magic</span>] {  
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>levelEffect</span> <span style=color:#f92672>:=</span> int(<span style=color:#a6e22e>math</span>.<span style=color:#a6e22e>Ceil</span>(float64(<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Level</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.1</span>))  
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Attacks</span>[<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Magic</span>] <span style=color:#f92672>+</span> <span style=color:#a6e22e>levelEffect</span>  
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>TakeDamage</code> 如果被其他角色攻击,血量将会减少,当血量为0时,男巫就会死亡.此处使用了指针类型<code>*Wizard</code>,因为当男巫受到伤害时必须及时减少男巫的血量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>w</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Wizard</span>) <span style=color:#a6e22e>TakeDamage</span>(<span style=color:#a6e22e>damage</span> <span style=color:#66d9ef>int</span>) {  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Blood</span> = <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Blood</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>damage</span>  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>GetInfo()</code> 获取男巫的名称和血量</p><p><code>IsDeath():</code> 检测男巫是否死亡</p><h5 id=wizard-own-methods>Wizard Own Methods:</h5><p><code>GetMana():</code> 获取男巫当前的法力值</p><p><code>SpendMana()</code> 消耗男巫的法力值</p><p><code>CreateWizard()</code> 创建男巫对象</p><h3 id=fighter-参考男巫>Fighter (参考男巫)</h3><h3 id=druid-参考男巫>Druid (参考男巫)</h3><h3 id=hero-战斗>Hero (战斗)</h3><p>我们已经定义了所有的英雄角色,现在开始让他们之间互相战斗,他们中只有一个能获胜幸存下来.
定义全局变量和随机函数:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fighterList</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>IHero</span>.<span style=color:#a6e22e>FightHero</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fighterNumberList</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>int</span>]<span style=color:#a6e22e>IHero</span>.<span style=color:#a6e22e>FightHero</span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>GetRandomID</span>(<span style=color:#a6e22e>limit</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>int</span> {  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Seed</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>UnixNano</span>())  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rndVictim</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(<span style=color:#a6e22e>limit</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>  
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rndVictim</span>  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>GetRandomBetweenID</span>(<span style=color:#a6e22e>minLimit</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>maxlimit</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>int</span> {  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Seed</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>UnixNano</span>())  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rndVictim</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(<span style=color:#a6e22e>maxlimit</span><span style=color:#f92672>-</span><span style=color:#a6e22e>minLimit</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>minLimit</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>  
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rndVictim</span>  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>isFighterDead</span> <span style=color:#66d9ef>bool</span> = <span style=color:#66d9ef>false</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>isWizardDead</span> <span style=color:#66d9ef>bool</span> = <span style=color:#66d9ef>false</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>isDruidDead</span> <span style=color:#66d9ef>bool</span> = <span style=color:#66d9ef>false</span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>TotalLive</span> <span style=color:#66d9ef>int</span> = <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MapRandomKeyGet</span>(<span style=color:#a6e22e>mapI</span> <span style=color:#66d9ef>interface</span>{}) <span style=color:#66d9ef>interface</span>{} {  
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>keys</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>ValueOf</span>(<span style=color:#a6e22e>mapI</span>).<span style=color:#a6e22e>MapKeys</span>()  
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>keys</span>[<span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(len(<span style=color:#a6e22e>keys</span>))].<span style=color:#a6e22e>Interface</span>()  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><code>fighterList</code>以英雄的名称保存英雄信息</li><li><code>fighterNumberList</code>根据英雄ID存储英雄名称</li><li><code>GetRandomID</code> 获取随机数</li><li><code>GetRandomBetweenID</code> 给定范围内获取随机数</li><li><code>isFighterDead, isWizardDead, isDruidDead</code> 每个英雄的生死状态</li><li><code>TotalLive</code> 几条生命</li><li><code>MapRandomKeyGet</code> 用来随机获取<code>Wizzard</code>的魔法技能,<code>Fighter</code>的武器,<code>Druid</code>的宠物</li></ul><h3 id=heromain>hero/main()</h3><p>首先我们创建默认的<code>wizard</code>,<code>fighter</code>和<code>druid</code>人物角色。由于每个英雄出手攻击都要等待确保其他英雄的攻击动作已经完成。所以我们使用<code>channels</code>来达到顺序战斗的效果。攻击动作完成之后才会继续接下来的战斗。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>merlin</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>wizard</span>.<span style=color:#a6e22e>CreateWizard</span>(<span style=color:#a6e22e>GetRandomBetweenID</span>(<span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>100</span>), <span style=color:#a6e22e>GetRandomBetweenID</span>(<span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>100</span>))
</span></span></code></pre></div><p>如果你注意上面的代码会发现，每个英雄的血量、法力和耐力值都是设置为50到100之间的随机数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>fighterList</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>IHero</span>.<span style=color:#a6e22e>FightHero</span>{<span style=color:#e6db74>&#34;fighter&#34;</span>: <span style=color:#a6e22e>barbar</span>, <span style=color:#e6db74>&#34;wizard&#34;</span>: <span style=color:#a6e22e>merlin</span>, <span style=color:#e6db74>&#34;druid&#34;</span>: <span style=color:#a6e22e>forest</span>}  
</span></span><span style=display:flex><span><span style=color:#a6e22e>fighterNumberList</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>int</span>]<span style=color:#a6e22e>IHero</span>.<span style=color:#a6e22e>FightHero</span>{<span style=color:#ae81ff>1</span>: <span style=color:#a6e22e>barbar</span>, <span style=color:#ae81ff>2</span>: <span style=color:#a6e22e>merlin</span>, <span style=color:#ae81ff>3</span>: <span style=color:#a6e22e>forest</span>}
</span></span></code></pre></div><ul><li>我们会将所有英雄名字和英雄对象以键值对的形式保存在<code>fightList</code> Map中</li><li>我们会像枚举一样使用<code>fighterNumberList</code>,随机的从这个map中取英雄</li></ul><p>接下来，我们会让角色在一个循环中战斗知道最后只有一个人存活</p></section><div class=paginator><a class=prev href=https://echotrue.github.io/blog/game/game-vocabulary-list/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>Game Vocabulary List</span></a>
<a class=next href=https://echotrue.github.io/blog/game/nano/one-nano-request/><span>One Nano Request</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2024 <a href=https://echotrue.github.io/>AXLROSE</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
Theme by
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>